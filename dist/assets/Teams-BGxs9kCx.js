import{g as te,m as ne,K as B,r as se,C as re,b as l,c as z,d as X,e as P,f as oe,h as j,_ as ae,i as ce,k as ie,j as o,u as q,R as le,a as me,l as Y,n as de,o as ue,p as k,L as pe}from"./index-DWVIrarL.js";import{S as A,F as Q,T as H,R as fe,M as ge,a as V}from"./index-7Imk3y3v.js";import{R as he,a as be,g as ye,B as I}from"./button-ZitA0x0c.js";import{R as xe,a as ve,C as _}from"./index-BwZGRhAa.js";import{N as Ce,R as je,u as Te,a as Se,A as Oe,F as M,I as Me,s as O}from"./index-CL68ldrU.js";import{R as Ee,C as L}from"./TextArea-ecw0KRlF.js";import{S as D}from"./index-CoBJDKc0.js";import{R as $e,a as Ie}from"./compact-item-C3Bf5F0_.js";import"./useForceUpdate-DW7K_nWO.js";const we=e=>{const{componentCls:t,iconCls:s,boxShadow:n,colorText:r,colorSuccess:a,colorError:d,colorWarning:u,colorInfo:c,fontSizeLG:i,motionEaseInOutCirc:m,motionDurationSlow:p,marginXS:y,paddingXS:h,borderRadiusLG:g,zIndexPopup:b,contentPadding:C,contentBg:T}=e,f=`${t}-notice`,v=new B("MessageMoveIn",{"0%":{padding:0,transform:"translateY(-100%)",opacity:0},"100%":{padding:h,transform:"translateY(0)",opacity:1}}),E=new B("MessageMoveOut",{"0%":{maxHeight:e.height,padding:h,opacity:1},"100%":{maxHeight:0,padding:0,opacity:0}}),S={padding:h,textAlign:"center",[`${t}-custom-content`]:{display:"flex",alignItems:"center"},[`${t}-custom-content > ${s}`]:{marginInlineEnd:y,fontSize:i},[`${f}-content`]:{display:"inline-block",padding:C,background:T,borderRadius:g,boxShadow:n,pointerEvents:"all"},[`${t}-success > ${s}`]:{color:a},[`${t}-error > ${s}`]:{color:d},[`${t}-warning > ${s}`]:{color:u},[`${t}-info > ${s},
      ${t}-loading > ${s}`]:{color:c}};return[{[t]:Object.assign(Object.assign({},se(e)),{color:r,position:"fixed",top:y,width:"100%",pointerEvents:"none",zIndex:b,[`${t}-move-up`]:{animationFillMode:"forwards"},[`
        ${t}-move-up-appear,
        ${t}-move-up-enter
      `]:{animationName:v,animationDuration:p,animationPlayState:"paused",animationTimingFunction:m},[`
        ${t}-move-up-appear${t}-move-up-appear-active,
        ${t}-move-up-enter${t}-move-up-enter-active
      `]:{animationPlayState:"running"},[`${t}-move-up-leave`]:{animationName:E,animationDuration:p,animationPlayState:"paused",animationTimingFunction:m},[`${t}-move-up-leave${t}-move-up-leave-active`]:{animationPlayState:"running"},"&-rtl":{direction:"rtl",span:{direction:"rtl"}}})},{[t]:{[`${f}-wrapper`]:Object.assign({},S)}},{[`${t}-notice-pure-panel`]:Object.assign(Object.assign({},S),{padding:0,textAlign:"start"})}]},Re=e=>({zIndexPopup:e.zIndexPopupBase+re+10,contentBg:e.colorBgElevated,contentPadding:`${(e.controlHeightLG-e.fontSize*e.lineHeight)/2}px ${e.paddingSM}px`}),J=te("Message",e=>{const t=ne(e,{height:150});return[we(t)]},Re);var Pe=function(e,t){var s={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(s[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(s[n[r]]=e[n[r]]);return s};const Fe={info:l.createElement(je,null),success:l.createElement(he,null),error:l.createElement($e,null),warning:l.createElement(be,null),loading:l.createElement(Ie,null)},Z=e=>{let{prefixCls:t,type:s,icon:n,children:r}=e;return l.createElement("div",{className:P(`${t}-custom-content`,`${t}-${s}`)},n||Fe[s],l.createElement("span",null,r))},Ae=e=>{const{prefixCls:t,className:s,type:n,icon:r,content:a}=e,d=Pe(e,["prefixCls","className","type","icon","content"]),{getPrefixCls:u}=l.useContext(z),c=t||u("message"),i=X(c),[m,p,y]=J(c,i);return m(l.createElement(Ce,Object.assign({},d,{prefixCls:c,className:P(s,p,`${c}-notice-pure-panel`,y,i),eventKey:"pure",duration:null,content:l.createElement(Z,{prefixCls:c,type:n,icon:r},a)})))};function Ne(e,t){return{motionName:t??`${e}-move-up`}}function G(e){let t;const s=new Promise(r=>{t=e(()=>{r(!0)})}),n=()=>{t==null||t()};return n.then=(r,a)=>s.then(r,a),n.promise=s,n}var ke=function(e,t){var s={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(s[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(s[n[r]]=e[n[r]]);return s};const _e=8,Le=3,De=e=>{let{children:t,prefixCls:s}=e;const n=X(s),[r,a,d]=J(s,n);return r(l.createElement(Se,{classNames:{list:P(a,d,n)}},t))},He=(e,t)=>{let{prefixCls:s,key:n}=t;return l.createElement(De,{prefixCls:s,key:n},e)},Ue=l.forwardRef((e,t)=>{const{top:s,prefixCls:n,getContainer:r,maxCount:a,duration:d=Le,rtl:u,transitionName:c,onAllRemoved:i}=e,{getPrefixCls:m,getPopupContainer:p,message:y,direction:h}=l.useContext(z),g=n||m("message"),b=()=>({left:"50%",transform:"translateX(-50%)",top:s??_e}),C=()=>P({[`${g}-rtl`]:u??h==="rtl"}),T=()=>Ne(g,c),f=l.createElement("span",{className:`${g}-close-x`},l.createElement(xe,{className:`${g}-close-icon`})),[v,E]=Te({prefixCls:g,style:b,className:C,motion:T,closable:!1,closeIcon:f,duration:d,getContainer:()=>(r==null?void 0:r())||(p==null?void 0:p())||document.body,maxCount:a,onAllRemoved:i,renderNotifications:He});return l.useImperativeHandle(t,()=>Object.assign(Object.assign({},v),{prefixCls:g,message:y})),E});let K=0;function ee(e){const t=l.useRef(null);return oe(),[l.useMemo(()=>{const n=c=>{var i;(i=t.current)===null||i===void 0||i.close(c)},r=c=>{if(!t.current){const F=()=>{};return F.then=()=>{},F}const{open:i,prefixCls:m,message:p}=t.current,y=`${m}-notice`,{content:h,icon:g,type:b,key:C,className:T,style:f,onClose:v}=c,E=ke(c,["content","icon","type","key","className","style","onClose"]);let S=C;return S==null&&(K+=1,S=`antd-message-${K}`),G(F=>(i(Object.assign(Object.assign({},E),{key:S,content:l.createElement(Z,{prefixCls:m,type:b,icon:g},h),placement:"top",className:P(b&&`${y}-${b}`,T,p==null?void 0:p.className),style:Object.assign(Object.assign({},p==null?void 0:p.style),f),onClose:()=>{v==null||v(),F()}})),()=>{n(S)}))},d={open:r,destroy:c=>{var i;c!==void 0?n(c):(i=t.current)===null||i===void 0||i.destroy()}};return["info","success","warning","error","loading"].forEach(c=>{const i=(m,p,y)=>{let h;m&&typeof m=="object"&&"content"in m?h=m:h={content:m};let g,b;typeof p=="function"?b=p:(g=p,b=y);const C=Object.assign(Object.assign({onClose:b,duration:g},h),{type:c});return r(C)};d[c]=i}),d},[]),l.createElement(Ue,Object.assign({key:"message-holder"},e,{ref:t}))]}function ze(e){return ee(e)}let x=null,$=e=>e(),w=[],R={};function W(){const{getContainer:e,duration:t,rtl:s,maxCount:n,top:r}=R,a=(e==null?void 0:e())||document.body;return{getContainer:()=>a,duration:t,rtl:s,maxCount:n,top:r}}const Ge=j.forwardRef((e,t)=>{const{messageConfig:s,sync:n}=e,{getPrefixCls:r}=l.useContext(z),a=R.prefixCls||r("message"),d=l.useContext(Oe),[u,c]=ee(Object.assign(Object.assign(Object.assign({},s),{prefixCls:a}),d.message));return j.useImperativeHandle(t,()=>{const i=Object.assign({},u);return Object.keys(i).forEach(m=>{i[m]=function(){return n(),u[m].apply(u,arguments)}}),{instance:i,sync:n}}),c}),Be=j.forwardRef((e,t)=>{const[s,n]=j.useState(W),r=()=>{n(W)};j.useEffect(r,[]);const a=ie(),d=a.getRootPrefixCls(),u=a.getIconPrefixCls(),c=a.getTheme(),i=j.createElement(Ge,{ref:t,sync:r,messageConfig:s});return j.createElement(ce,{prefixCls:d,iconPrefixCls:u,theme:c},a.holderRender?a.holderRender(i):i)});function N(){if(!x){const e=document.createDocumentFragment(),t={fragment:e};x=t,$(()=>{ye()(j.createElement(Be,{ref:n=>{const{instance:r,sync:a}=n||{};Promise.resolve().then(()=>{!t.instance&&r&&(t.instance=r,t.sync=a,N())})}}),e)});return}x.instance&&(w.forEach(e=>{const{type:t,skipped:s}=e;if(!s)switch(t){case"open":{$(()=>{const n=x.instance.open(Object.assign(Object.assign({},R),e.config));n==null||n.then(e.resolve),e.setCloseFn(n)});break}case"destroy":$(()=>{x==null||x.instance.destroy(e.key)});break;default:$(()=>{var n;const r=(n=x.instance)[t].apply(n,ae(e.args));r==null||r.then(e.resolve),e.setCloseFn(r)})}}),w=[])}function Ve(e){R=Object.assign(Object.assign({},R),e),$(()=>{var t;(t=x==null?void 0:x.sync)===null||t===void 0||t.call(x)})}function Ke(e){const t=G(s=>{let n;const r={type:"open",config:e,resolve:s,setCloseFn:a=>{n=a}};return w.push(r),()=>{n?$(()=>{n()}):r.skipped=!0}});return N(),t}function We(e,t){const s=G(n=>{let r;const a={type:e,args:t,resolve:n,setCloseFn:d=>{r=d}};return w.push(a),()=>{r?$(()=>{r()}):a.skipped=!0}});return N(),s}const Xe=e=>{w.push({type:"destroy",key:e}),N()},qe=["success","info","warning","error","loading"],Ye={open:Ke,destroy:Xe,config:Ve,useMessage:ze,_InternalPanelDoNotUseOrYouWillBeFired:Ae},U=Ye;qe.forEach(e=>{U[e]=function(){for(var t=arguments.length,s=new Array(t),n=0;n<t;n++)s[n]=arguments[n];return We(e,s)}});const Qe=({onCreateTeam:e})=>o.jsx(A,{children:o.jsx(I,{type:"primary",icon:o.jsx(ve,{}),onClick:e,children:"Create Team"})}),Je=({onEdit:e,onView:t})=>{const{teams:s,loading:n}=q(a=>a.teams),r=[{title:"Team Name",dataIndex:"name",key:"name"},{title:"Members",dataIndex:"members",key:"members",render:a=>o.jsxs(H,{children:[a.length," members"]})},{title:"Created At",dataIndex:"createdAt",key:"createdAt"},{title:"Actions",key:"actions",render:(a,d)=>o.jsxs(A,{children:[o.jsx(I,{type:"primary",onClick:()=>t(d),children:"View"}),o.jsx(I,{onClick:()=>e(d),children:"Edit"})]})}];return o.jsx(Q,{columns:r,dataSource:s,loading:n,rowKey:"id"})},Ze=({initialValues:e,onSubmit:t,loading:s})=>{const[n]=M.useForm();return j.useEffect(()=>{e&&n.setFieldsValue(e)},[e,n]),o.jsxs(M,{form:n,layout:"vertical",onFinish:t,children:[o.jsx(M.Item,{name:"name",label:"Team Name",rules:[{required:!0,message:"Please enter team name"}],children:o.jsx(Me,{})}),o.jsx(M.Item,{children:o.jsx(I,{type:"primary",htmlType:"submit",loading:s,children:e?"Update Team":"Create Team"})})]})},et=({members:e})=>{const t=e.filter(n=>n.status==="active").length,s=e.filter(n=>n.isTemporaryLeave).length;return o.jsxs(Ee,{gutter:16,children:[o.jsx(L,{span:8,children:o.jsx(_,{children:o.jsx(D,{title:"Total Members",value:e.length,prefix:o.jsx(le,{})})})}),o.jsx(L,{span:8,children:o.jsx(_,{children:o.jsx(D,{title:"Active Members",value:t,prefix:o.jsx(me,{}),valueStyle:{color:"#3f8600"}})})}),o.jsx(L,{span:8,children:o.jsx(_,{children:o.jsx(D,{title:"On Leave",value:s,prefix:o.jsx(fe,{}),valueStyle:{color:"#cf1322"}})})})]})},tt=({members:e,onRemoveMember:t,loading:s})=>{const n=[{title:"Name",dataIndex:"name",key:"name"},{title:"Role",dataIndex:"role",key:"role",render:r=>o.jsx(H,{color:"blue",children:r})},{title:"Status",dataIndex:"status",key:"status",render:r=>o.jsx(H,{color:r==="active"?"green":"red",children:r})},{title:"Actions",key:"actions",render:(r,a)=>o.jsx(I,{danger:!0,onClick:()=>t(a.id),children:"Remove"})}];return o.jsx(Q,{columns:n,dataSource:e,loading:s,rowKey:"id",pagination:!1})},nt=({members:e,loading:t,onAddMembers:s,onRemoveMember:n})=>o.jsxs(A,{direction:"vertical",size:"large",style:{width:"100%"},children:[o.jsx(et,{members:e}),o.jsx(tt,{members:e,onRemoveMember:n,loading:t}),o.jsx(I,{type:"primary",onClick:s,children:"Add Members"})]}),st=({visible:e,onCancel:t,onAdd:s,loading:n,currentMembers:r})=>{const[a]=M.useForm(),d=c=>{s(c.userIds),a.resetFields()},u=l.useMemo(()=>Y.filter(c=>!r.includes(c.id)),[r]);return o.jsx(ge,{title:"Add Team Members",open:e,onCancel:t,footer:null,children:o.jsxs(M,{form:a,onFinish:d,children:[o.jsx(M.Item,{name:"userIds",rules:[{required:!0,message:"Please select members"}],children:o.jsx(V,{mode:"multiple",placeholder:"Select members",style:{width:"100%"},children:u.map(c=>o.jsx(V.Option,{value:c.id,children:c.name},c.id))})}),o.jsx(M.Item,{children:o.jsx(I,{type:"primary",htmlType:"submit",loading:n,children:"Add Members"})})]})})},rt=e=>({...e,id:Date.now().toString(),members:[],createdAt:new Date().toISOString()}),ot=(e,t)=>({...e,members:[...e.members,...t]}),at=(e,t)=>({...e,members:e.members.filter(s=>s!==t)}),ct=()=>{const[e,t]=l.useState(null),[s,n]=l.useState(!1),r=de(),a=l.useCallback(i=>{try{const m=rt(i);r(ue(m)),O.success({message:"Team Created",description:"The team has been created successfully."})}catch{O.error({message:"Error",description:"Failed to create team."})}},[r]),d=l.useCallback(i=>{try{r(k(i)),t(i),O.success({message:"Team Updated",description:"The team has been updated successfully."})}catch{O.error({message:"Error",description:"Failed to update team."})}},[r]),u=l.useCallback(i=>{if(e)try{const m=ot(e,i);r(k(m)),t(m),n(!1),O.success({message:"Members Added",description:"Team members have been added successfully."})}catch{O.error({message:"Error",description:"Failed to add members."})}},[e,r]),c=l.useCallback(i=>{if(e)try{const m=at(e,i);r(k(m)),t(m),O.success({message:"Member Removed",description:"Team member has been removed successfully."})}catch{O.error({message:"Error",description:"Failed to remove member."})}},[e,r]);return{selectedTeam:e,showAddMember:s,setSelectedTeam:t,setShowAddMember:n,handleCreateTeam:a,handleUpdateTeam:d,handleAddMembers:u,handleRemoveMember:c}},it=e=>{const[t,s]=l.useState([]),[n,r]=l.useState(!1),[a,d]=l.useState(null);return l.useEffect(()=>{(async()=>{if(!e.length){s([]);return}r(!0);try{await new Promise(i=>setTimeout(i,500));const c=Y.filter(i=>e.includes(i.id));s(c),d(null)}catch(c){d(c instanceof Error?c.message:"Failed to fetch members")}finally{r(!1)}})()},[e]),{members:t,loading:n,error:a}},lt=e=>e?e.length<3?"Team name must be at least 3 characters":e.length>50?"Team name must not exceed 50 characters":null:"Team name is required",mt=e=>e.length?e.length>50?"Team cannot have more than 50 members":null:"Team must have at least one member",dt=e=>{const t=[],s=lt(e.name||"");if(s&&t.push(s),e.members){const n=mt(e.members);n&&t.push(n)}return t},Ct=()=>{const{teams:e,loading:t}=q(f=>f.teams);console.log(e);const{selectedTeam:s,showAddMember:n,setSelectedTeam:r,setShowAddMember:a,handleCreateTeam:d,handleUpdateTeam:u,handleAddMembers:c,handleRemoveMember:i}=ct(),m=l.useMemo(()=>(s==null?void 0:s.members)??[],[s==null?void 0:s.members]),{members:p,loading:y,error:h}=it(m),g=f=>{const v=dt(f);if(v.length){v.forEach(E=>U.error(E));return}s?u({...s,...f}):d(f)},b=f=>r(f),C=f=>r(f);h&&U.error(h);const T=t||y;return o.jsx(pe,{spinning:T,children:o.jsxs(A,{direction:"vertical",size:"large",style:{width:"100%",display:"flex"},children:[o.jsx(Qe,{onCreateTeam:()=>r(null)}),s?o.jsx(nt,{team:s,members:p,onAddMembers:()=>a(!0),onRemoveMember:i}):o.jsx(Ze,{onSubmit:g,initialValues:s}),o.jsx(Je,{onEdit:b,onView:C}),o.jsx(st,{visible:n,onCancel:()=>a(!1),onAdd:c,currentMembers:(s==null?void 0:s.members)??[],loading:T})]})})};export{Ct as default};
